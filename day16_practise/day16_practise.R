library(arules)
data(Epub)
summary(Epub)
# 아예 데이터 자체가 이를 연습할수있게 가공되어 나옴

inspect(Epub[1:10])

itemFrequencyPlot(Epub, support = 0.01, main = "item frequency plot(support 1%)")

itemFrequencyPlot(Epub, topN = 25, main = "item(support top 25)")
abline(h=0.01, col="red")


# 1. Epub 데이터를 통해 연관규칙 만들기
# support, confidence 다양하게 설정해서 최적값 찾기
# minlen=2 고정

# support 최적값 찾기(0.01~0.001)
# support=0.006
epubrules <- apriori(Epub, list(support=0.006, confidence=0.25, minlen=2))
epubrules  #set of 0 rules -> 기준이 너무 높았나보다

# confidence=0.25, minlen=2
# support   set of rules
# 0.006      0
# 0.005      0
# 0.004      1
# 0.003      1
# 0.002      4
# 0.001      45

# support=0.001
epubrules <- apriori(Epub, list(support=0.001, confidence=0.25, minlen=2))
epubrules #set of 45 rules


# confidence 최적값 찾기

# support=0.001, minlen=2
# confidence   set of rules     size                 lift
# 0.20             65        2(62), 3(3)   최소(11.19), 최대(454.75)
# 0.25             45        2(42), 3(3)   최소(16.81), 최대(454.75)
# 0.30             30        2(27), 3(3)   최소(16.81), 최대(454.75)

# confidence=0.25
epubrules <- apriori(Epub, list(support=0.001, confidence=0.25, minlen=2))
epubrules
summary(epubrules)


# 2. 정렬
# lift, confidence, support

# 1) lift 기준으로
# 상위 20개
inspect(sort(epubrules, by="lift")[1:20])

# lhs                  rhs       support     confidence coverage    lift      count
# [1]  {doc_6e7,doc_6e8} => {doc_6e9} 0.001080806 0.8095238  0.001335113 454.75000 17   
# [2]  {doc_6e7,doc_6e9} => {doc_6e8} 0.001080806 0.8500000  0.001271537 417.80156 17   
# [3]  {doc_6e8,doc_6e9} => {doc_6e7} 0.001080806 0.8947368  0.001207960 402.09474 17   
# [4]  {doc_6e9}         => {doc_6e8} 0.001207960 0.6785714  0.001780151 333.53906 19   
# [5]  {doc_6e8}         => {doc_6e9} 0.001207960 0.5937500  0.002034459 333.53906 19   
# [6]  {doc_6e9}         => {doc_6e7} 0.001271537 0.7142857  0.001780151 321.00000 20   
# [7]  {doc_6e7}         => {doc_6e9} 0.001271537 0.5714286  0.002225189 321.00000 20   
# [8]  {doc_506}         => {doc_507} 0.001207960 0.6551724  0.001843728 303.09432 19   
# [9]  {doc_507}         => {doc_506} 0.001207960 0.5588235  0.002161612 303.09432 19   
# [10] {doc_6e8}         => {doc_6e7} 0.001335113 0.6562500  0.002034459 294.91875 21   
# [11] {doc_6e7}         => {doc_6e8} 0.001335113 0.6000000  0.002225189 294.91875 21   
# [12] {doc_87c}         => {doc_882} 0.001335113 0.6000000  0.002225189 171.58909 21   
# [13] {doc_882}         => {doc_87c} 0.001335113 0.3818182  0.003496726 171.58909 21   
# [14] {doc_714}         => {doc_574} 0.001080806 0.3695652  0.002924534 113.97826 17   
# [15] {doc_574}         => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [16] {doc_574}         => {doc_3c4} 0.001017229 0.3137255  0.003242418 100.70588 16   
# [17] {doc_3c4}         => {doc_574} 0.001017229 0.3265306  0.003115265 100.70588 16   
# [18] {doc_4b4}         => {doc_3c4} 0.001207960 0.2835821  0.004259648  91.02985 19   
# [19] {doc_3c4}         => {doc_4b4} 0.001207960 0.3877551  0.003115265  91.02985 19   
# [20] {doc_749}         => {doc_74a} 0.001017229 0.3555556  0.002860957  86.03897 16  

# 하위 20개
inspect(sort(epubrules, by="lift", decreasing = F)[1:20])

# lhs          rhs       support     confidence coverage    lift     count
# [1]  {doc_470} => {doc_4c6} 0.001080806 0.2048193  0.005276877 11.18612 17   
# [2]  {doc_359} => {doc_4c7} 0.001398690 0.2056075  0.006802721 15.47368 22   
# [3]  {doc_364} => {doc_71}  0.002733804 0.2336957  0.011698137 15.91255 43   
# [4]  {doc_72f} => {doc_813} 0.004068917 0.3516484  0.011570984 16.81178 64   
# [5]  {doc_1a2} => {doc_4c7} 0.002098035 0.2391304  0.008773603 17.99657 33   
# [6]  {doc_c21} => {doc_8f9} 0.001080806 0.2207792  0.004895416 18.08665 17   
# [7]  {doc_972} => {doc_8f9} 0.002161612 0.2281879  0.009472948 18.69358 34   
# [8]  {doc_a77} => {doc_8f9} 0.001271537 0.2531646  0.005022570 20.73972 20   
# [9]  {doc_60e} => {doc_6bf} 0.002670227 0.2745098  0.009727255 21.06227 42   
# [10] {doc_6bf} => {doc_60e} 0.002670227 0.2048780  0.013033251 21.06227 42   
# [11] {doc_671} => {doc_707} 0.001017229 0.2162162  0.004704686 21.66156 16   
# [12] {doc_c69} => {doc_8f9} 0.001207960 0.2753623  0.004386801 22.55820 19   
# [13] {doc_971} => {doc_8f9} 0.001271537 0.2816901  0.004513955 23.07658 20   
# [14] {doc_466} => {doc_19f} 0.001525844 0.2264151  0.006739144 25.80640 24   
# [15] {doc_971} => {doc_972} 0.001335113 0.2957746  0.004513955 31.22308 21   
# [16] {doc_5c9} => {doc_359} 0.001080806 0.2297297  0.004704686 33.77027 17   
# [17] {doc_4da} => {doc_84b} 0.001780151 0.2314050  0.007692797 34.01653 28   
# [18] {doc_84b} => {doc_4da} 0.001780151 0.2616822  0.006802721 34.01653 28   
# [19] {doc_649} => {doc_5ca} 0.001144383 0.2142857  0.005340454 40.12500 18   
# [20] {doc_5ca} => {doc_649} 0.001144383 0.2142857  0.005340454 40.12500 18 


# 2) confidence 기준으로 
# 상위 20개
inspect(sort(epubrules, by="confidence")[1:20])

# lhs                  rhs       support     confidence coverage    lift      count
# [1]  {doc_6e8,doc_6e9} => {doc_6e7} 0.001080806 0.8947368  0.001207960 402.09474 17   
# [2]  {doc_6e7,doc_6e9} => {doc_6e8} 0.001080806 0.8500000  0.001271537 417.80156 17   
# [3]  {doc_6e7,doc_6e8} => {doc_6e9} 0.001080806 0.8095238  0.001335113 454.75000 17   
# [4]  {doc_6e9}         => {doc_6e7} 0.001271537 0.7142857  0.001780151 321.00000 20   
# [5]  {doc_6e9}         => {doc_6e8} 0.001207960 0.6785714  0.001780151 333.53906 19   
# [6]  {doc_6e8}         => {doc_6e7} 0.001335113 0.6562500  0.002034459 294.91875 21   
# [7]  {doc_506}         => {doc_507} 0.001207960 0.6551724  0.001843728 303.09432 19   
# [8]  {doc_6e7}         => {doc_6e8} 0.001335113 0.6000000  0.002225189 294.91875 21   
# [9]  {doc_87c}         => {doc_882} 0.001335113 0.6000000  0.002225189 171.58909 21   
# [10] {doc_6e8}         => {doc_6e9} 0.001207960 0.5937500  0.002034459 333.53906 19   
# [11] {doc_6e7}         => {doc_6e9} 0.001271537 0.5714286  0.002225189 321.00000 20   
# [12] {doc_507}         => {doc_506} 0.001207960 0.5588235  0.002161612 303.09432 19   
# [13] {doc_4bf}         => {doc_4ac} 0.001080806 0.5000000  0.002161612  77.10294 17   
# [14] {doc_4ac}         => {doc_16e} 0.002797381 0.4313725  0.006484837  53.42566 44   
# [15] {doc_3c4}         => {doc_4b4} 0.001207960 0.3877551  0.003115265  91.02985 19   
# [16] {doc_882}         => {doc_87c} 0.001335113 0.3818182  0.003496726 171.58909 21   
# [17] {doc_714}         => {doc_574} 0.001080806 0.3695652  0.002924534 113.97826 17   
# [18] {doc_3c4}         => {doc_3d6} 0.001144383 0.3673469  0.003115265  79.15068 18   
# [19] {doc_764}         => {doc_4b4} 0.001207960 0.3653846  0.003305995  85.77813 19   
# [20] {doc_749}         => {doc_74a} 0.001017229 0.3555556  0.002860957  86.03897 16   

# 하위 20개
inspect(sort(epubrules, by="confidence", decreasing = F)[1:20])

# lhs          rhs       support     confidence coverage    lift     count
# [1]  {doc_470} => {doc_4c6} 0.001080806 0.2048193  0.005276877 11.18612 17   
# [2]  {doc_6bf} => {doc_60e} 0.002670227 0.2048780  0.013033251 21.06227 42   
# [3]  {doc_359} => {doc_4c7} 0.001398690 0.2056075  0.006802721 15.47368 22   
# [4]  {doc_649} => {doc_5ca} 0.001144383 0.2142857  0.005340454 40.12500 18   
# [5]  {doc_5ca} => {doc_649} 0.001144383 0.2142857  0.005340454 40.12500 18   
# [6]  {doc_5ca} => {doc_7da} 0.001144383 0.2142857  0.005340454 48.15000 18   
# [7]  {doc_671} => {doc_707} 0.001017229 0.2162162  0.004704686 21.66156 16   
# [8]  {doc_800} => {doc_803} 0.001144383 0.2168675  0.005276877 44.88301 18   
# [9]  {doc_3d6} => {doc_4b4} 0.001017229 0.2191781  0.004641109 51.45451 16   
# [10] {doc_c21} => {doc_8f9} 0.001080806 0.2207792  0.004895416 18.08665 17   
# [11] {doc_466} => {doc_19f} 0.001525844 0.2264151  0.006739144 25.80640 24   
# [12] {doc_972} => {doc_8f9} 0.002161612 0.2281879  0.009472948 18.69358 34   
# [13] {doc_5c9} => {doc_359} 0.001080806 0.2297297  0.004704686 33.77027 17   
# [14] {doc_4da} => {doc_84b} 0.001780151 0.2314050  0.007692797 34.01653 28   
# [15] {doc_364} => {doc_71}  0.002733804 0.2336957  0.011698137 15.91255 43   
# [16] {doc_803} => {doc_800} 0.001144383 0.2368421  0.004831839 44.88301 18   
# [17] {doc_4b4} => {doc_3d6} 0.001017229 0.2388060  0.004259648 51.45451 16   
# [18] {doc_1a2} => {doc_4c7} 0.002098035 0.2391304  0.008773603 17.99657 33   
# [19] {doc_74a} => {doc_749} 0.001017229 0.2461538  0.004132494 86.03897 16   
# [20] {doc_3d6} => {doc_3c4} 0.001144383 0.2465753  0.004641109 79.15068 18


# 3) support 기준으로 
# 상위 20개
inspect(sort(epubrules, by="support")[1:20])

# lhs          rhs       support     confidence coverage    lift      count
# [1]  {doc_72f} => {doc_813} 0.004068917 0.3516484  0.011570984  16.81178 64   
# [2]  {doc_4ac} => {doc_16e} 0.002797381 0.4313725  0.006484837  53.42566 44   
# [3]  {doc_16e} => {doc_4ac} 0.002797381 0.3464567  0.008074258  53.42566 44   
# [4]  {doc_364} => {doc_71}  0.002733804 0.2336957  0.011698137  15.91255 43   
# [5]  {doc_60e} => {doc_6bf} 0.002670227 0.2745098  0.009727255  21.06227 42   
# [6]  {doc_6bf} => {doc_60e} 0.002670227 0.2048780  0.013033251  21.06227 42   
# [7]  {doc_972} => {doc_8f9} 0.002161612 0.2281879  0.009472948  18.69358 34   
# [8]  {doc_1a2} => {doc_4c7} 0.002098035 0.2391304  0.008773603  17.99657 33   
# [9]  {doc_424} => {doc_359} 0.001843728 0.3020833  0.006103376  44.40625 29   
# [10] {doc_359} => {doc_424} 0.001843728 0.2710280  0.006802721  44.40625 29   
# [11] {doc_4da} => {doc_84b} 0.001780151 0.2314050  0.007692797  34.01653 28   
# [12] {doc_84b} => {doc_4da} 0.001780151 0.2616822  0.006802721  34.01653 28   
# [13] {doc_8a8} => {doc_8af} 0.001716574 0.2903226  0.005912645  47.07715 27   
# [14] {doc_8af} => {doc_8a8} 0.001716574 0.2783505  0.006166953  47.07715 27   
# [15] {doc_803} => {doc_3fc} 0.001589421 0.3289474  0.004831839  59.47142 25   
# [16] {doc_3fc} => {doc_803} 0.001589421 0.2873563  0.005531184  59.47142 25   
# [17] {doc_466} => {doc_19f} 0.001525844 0.2264151  0.006739144  25.80640 24   
# [18] {doc_359} => {doc_4c7} 0.001398690 0.2056075  0.006802721  15.47368 22   
# [19] {doc_6e8} => {doc_6e7} 0.001335113 0.6562500  0.002034459 294.91875 21   
# [20] {doc_6e7} => {doc_6e8} 0.001335113 0.6000000  0.002225189 294.91875 21


# 하위 20개
inspect(sort(epubrules, by="support", decreasing = F)[1:20])

# lhs                  rhs       support     confidence coverage    lift      count
# [1]  {doc_749}         => {doc_74a} 0.001017229 0.3555556  0.002860957  86.03897 16   
# [2]  {doc_74a}         => {doc_749} 0.001017229 0.2461538  0.004132494  86.03897 16   
# [3]  {doc_3d6}         => {doc_4b4} 0.001017229 0.2191781  0.004641109  51.45451 16   
# [4]  {doc_4b4}         => {doc_3d6} 0.001017229 0.2388060  0.004259648  51.45451 16   
# [5]  {doc_3c4}         => {doc_574} 0.001017229 0.3265306  0.003115265 100.70588 16   
# [6]  {doc_574}         => {doc_3c4} 0.001017229 0.3137255  0.003242418 100.70588 16   
# [7]  {doc_5be}         => {doc_5ca} 0.001017229 0.3200000  0.003178842  59.92000 16   
# [8]  {doc_671}         => {doc_707} 0.001017229 0.2162162  0.004704686  21.66156 16   
# [9]  {doc_470}         => {doc_4c6} 0.001080806 0.2048193  0.005276877  11.18612 17   
# [10] {doc_714}         => {doc_574} 0.001080806 0.3695652  0.002924534 113.97826 17   
# [11] {doc_574}         => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [12] {doc_4bf}         => {doc_4ac} 0.001080806 0.5000000  0.002161612  77.10294 17   
# [13] {doc_574}         => {doc_4b4} 0.001080806 0.3333333  0.003242418  78.25373 17   
# [14] {doc_4b4}         => {doc_574} 0.001080806 0.2537313  0.004259648  78.25373 17   
# [15] {doc_c21}         => {doc_8f9} 0.001080806 0.2207792  0.004895416  18.08665 17   
# [16] {doc_5c9}         => {doc_359} 0.001080806 0.2297297  0.004704686  33.77027 17   
# [17] {doc_6e8,doc_6e9} => {doc_6e7} 0.001080806 0.8947368  0.001207960 402.09474 17   
# [18] {doc_6e7,doc_6e9} => {doc_6e8} 0.001080806 0.8500000  0.001271537 417.80156 17   
# [19] {doc_6e7,doc_6e8} => {doc_6e9} 0.001080806 0.8095238  0.001335113 454.75000 17   
# [20] {doc_3d6}         => {doc_3c4} 0.001144383 0.2465753  0.004641109  79.15068 18   


# 추가 : lift -> support -> confidence 순의 기준으로 나열한 상위 20개
inspect(sort(epubrules, by=c("lift","support","confidence"))[1:20])

#      lhs                  rhs       support     confidence coverage    lift      count
# [1]  {doc_6e7,doc_6e8} => {doc_6e9} 0.001080806 0.8095238  0.001335113 454.75000 17   
# [2]  {doc_6e7,doc_6e9} => {doc_6e8} 0.001080806 0.8500000  0.001271537 417.80156 17   
# [3]  {doc_6e8,doc_6e9} => {doc_6e7} 0.001080806 0.8947368  0.001207960 402.09474 17   
# [4]  {doc_6e9}         => {doc_6e8} 0.001207960 0.6785714  0.001780151 333.53906 19   
# [5]  {doc_6e8}         => {doc_6e9} 0.001207960 0.5937500  0.002034459 333.53906 19   
# [6]  {doc_6e9}         => {doc_6e7} 0.001271537 0.7142857  0.001780151 321.00000 20   
# [7]  {doc_6e7}         => {doc_6e9} 0.001271537 0.5714286  0.002225189 321.00000 20   
# [8]  {doc_506}         => {doc_507} 0.001207960 0.6551724  0.001843728 303.09432 19   
# [9]  {doc_507}         => {doc_506} 0.001207960 0.5588235  0.002161612 303.09432 19   
# [10] {doc_6e8}         => {doc_6e7} 0.001335113 0.6562500  0.002034459 294.91875 21   
# [11] {doc_6e7}         => {doc_6e8} 0.001335113 0.6000000  0.002225189 294.91875 21   
# [12] {doc_87c}         => {doc_882} 0.001335113 0.6000000  0.002225189 171.58909 21   
# [13] {doc_882}         => {doc_87c} 0.001335113 0.3818182  0.003496726 171.58909 21   
# [14] {doc_714}         => {doc_574} 0.001080806 0.3695652  0.002924534 113.97826 17   
# [15] {doc_574}         => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [16] {doc_574}         => {doc_3c4} 0.001017229 0.3137255  0.003242418 100.70588 16   
# [17] {doc_3c4}         => {doc_574} 0.001017229 0.3265306  0.003115265 100.70588 16   
# [18] {doc_4b4}         => {doc_3c4} 0.001207960 0.2835821  0.004259648  91.02985 19   
# [19] {doc_3c4}         => {doc_4b4} 0.001207960 0.3877551  0.003115265  91.02985 19   
# [20] {doc_749}         => {doc_74a} 0.001017229 0.3555556  0.002860957  86.03897 16


# 1) doc_6e7, doc_6e8, doc_6e9이 많이 보인다
# 2) doc_5XX 형식의 문서가 많이 보인다
# 3) lhs에 doc_574인 문서
# 4) lhs에 doc_3c4인 문서
# 5) rhs에 doc_7XX 형식의 문서


# 3. 연관규칙 부분집합
# support로 진행
# in, pin, ain 활용
# 만약, 특정도서가 왼쪽에 있는 경우(lhs에 있는 것이 궁금하다)
# items %in% c("doc1","doc2")
# 규칙의 양쪽에 "doc1" 또는 "doc2"가 있는 경우
# lhs %in% c("doc1","doc2")
# 규칙의 왼쪽에 "doc1" 또는 "doc2"가 있는 경우

# 1) doc_6e7, doc_6e8, doc_6e9이 많이 보인다

interest1 <- subset(epubrules, items %in% c("doc_6e7","doc_6e8","doc_6e9"))
inspect(interest1)

#     lhs                  rhs       support     confidence coverage    lift     count
# [1] {doc_6e9}         => {doc_6e8} 0.001207960 0.6785714  0.001780151 333.5391 19   
# [2] {doc_6e8}         => {doc_6e9} 0.001207960 0.5937500  0.002034459 333.5391 19   
# [3] {doc_6e9}         => {doc_6e7} 0.001271537 0.7142857  0.001780151 321.0000 20   
# [4] {doc_6e7}         => {doc_6e9} 0.001271537 0.5714286  0.002225189 321.0000 20   
# [5] {doc_6e8}         => {doc_6e7} 0.001335113 0.6562500  0.002034459 294.9187 21   
# [6] {doc_6e7}         => {doc_6e8} 0.001335113 0.6000000  0.002225189 294.9187 21   
# [7] {doc_6e8,doc_6e9} => {doc_6e7} 0.001080806 0.8947368  0.001207960 402.0947 17   
# [8] {doc_6e7,doc_6e9} => {doc_6e8} 0.001080806 0.8500000  0.001271537 417.8016 17   
# [9] {doc_6e7,doc_6e8} => {doc_6e9} 0.001080806 0.8095238  0.001335113 454.7500 17

# 분석
# lhs와 rhs 어디든 해당 문서가 있는 경우로 출력을 했음에도 불구하고
# lhs와 rhs 모두 "doc_6e7","doc_6e8","doc_6e9"로 이루어져 있었다.
# lift 역시 최소 294.9187로 매우 높았다
# 이 세 문서의 경우, 각각이 서로와 모두 연관성이 높은 것으로 보인다.
# 따라서 문서 배치 시에 함께 배열하는 것을 권장한다.


# 2) doc_5XX 형식의 문서가 많이 보인다

interest2 <- subset(epubrules, items %pin% "doc_5")
inspect(interest2)

#      lhs          rhs       support     confidence coverage    lift      count
# [1]  {doc_506} => {doc_507} 0.001207960 0.6551724  0.001843728 303.09432 19   
# [2]  {doc_507} => {doc_506} 0.001207960 0.5588235  0.002161612 303.09432 19   
# [3]  {doc_714} => {doc_574} 0.001080806 0.3695652  0.002924534 113.97826 17   
# [4]  {doc_574} => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [5]  {doc_3c4} => {doc_574} 0.001017229 0.3265306  0.003115265 100.70588 16   
# [6]  {doc_574} => {doc_3c4} 0.001017229 0.3137255  0.003242418 100.70588 16   
# [7]  {doc_574} => {doc_4b4} 0.001080806 0.3333333  0.003242418  78.25373 17   
# [8]  {doc_4b4} => {doc_574} 0.001080806 0.2537313  0.004259648  78.25373 17   
# [9]  {doc_5be} => {doc_5ca} 0.001017229 0.3200000  0.003178842  59.92000 16   
# [10] {doc_649} => {doc_5ca} 0.001144383 0.2142857  0.005340454  40.12500 18   
# [11] {doc_5ca} => {doc_649} 0.001144383 0.2142857  0.005340454  40.12500 18   
# [12] {doc_5ca} => {doc_7da} 0.001144383 0.2142857  0.005340454  48.15000 18   
# [13] {doc_7da} => {doc_5ca} 0.001144383 0.2571429  0.004450378  48.15000 18   
# [14] {doc_5c9} => {doc_359} 0.001080806 0.2297297  0.004704686  33.77027 17 

# doc_506 <=> doc_507의 연관성이 높음
# doc_574 <=> doc_714 또는 doc_4b4 또는 doc_3c4
# doc_5ca <=> doc_679 또는 doc_7da 
# 위와 같은 세 경우가 연관성이 높았다

# 3) lhs에 doc_574인 문서

interest3 <- subset(epubrules, lhs %in% "doc_574")
inspect(interest3)

#     lhs          rhs       support     confidence coverage    lift      count
# [1] {doc_574} => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [2] {doc_574} => {doc_3c4} 0.001017229 0.3137255  0.003242418 100.70588 16   
# [3] {doc_574} => {doc_4b4} 0.001080806 0.3333333  0.003242418  78.25373 17   

# doc_574 <=> doc_714 또는 doc_3c4 또는 doc_4b4와 연관성이 높았다

# 4) lhs에 doc_3c4인 문서

interest4 <- subset(epubrules, lhs %in% "doc_3c4")
inspect(interest4)

#     lhs          rhs       support     confidence coverage    lift      count
# [1] {doc_3c4} => {doc_3d6} 0.001144383 0.3673469  0.003115265  79.15068 18   
# [2] {doc_3c4} => {doc_574} 0.001017229 0.3265306  0.003115265 100.70588 16   
# [3] {doc_3c4} => {doc_4b4} 0.001207960 0.3877551  0.003115265  91.02985 19   

# 분석
# doc_3c4 <=> doc_3d6 또는 doc_574 또는 doc_4b4와 연관성이 높았다.
# 위의 3)번 과정에서 doc_574를 분석했었다.
# doc_574를 다운 받는 경우, doc_3c4를 함께 다운 받는다는 연관성을 확인했었고
# 추가로 doc_4b4도 연관성이 있다는 점을 확인했었다.
# 이번 4)과정에서 doc_3c4와 doc_4b4도 연관성이 있음을 확인함에 따라
# doc_3c4와 doc_4b4, doc_574는 서로 상호적으로 연관성이 있음을 확인했다.


# 5) rhs에 doc_7XX 형식의 문서
interest5 <- subset(epubrules, rhs %pin% "doc_7")
inspect(interest5)

#     lhs          rhs       support     confidence coverage    lift      count
# [1] {doc_574} => {doc_714} 0.001080806 0.3333333  0.003242418 113.97826 17   
# [2] {doc_749} => {doc_74a} 0.001017229 0.3555556  0.002860957  86.03897 16   
# [3] {doc_74a} => {doc_749} 0.001017229 0.2461538  0.004132494  86.03897 16   
# [4] {doc_4b4} => {doc_764} 0.001207960 0.2835821  0.004259648  85.77813 19   
# [5] {doc_5ca} => {doc_7da} 0.001144383 0.2142857  0.005340454  48.15000 18   
# [6] {doc_671} => {doc_707} 0.001017229 0.2162162  0.004704686  21.66156 16   
# [7] {doc_364} => {doc_71}  0.002733804 0.2336957  0.011698137  15.91255 43   


# 최종 분석
# (성급한 일반화일 수 있으나) doc_ 뒤에 오는 숫자와 알파벳의 조합이
# 비슷한 문서일수록 연관성이 나타났다.
# (예외의 경우도 충분히 있었으나) doc_ 뒤에 오는 세자리 중
# 앞자리부터 2자리가 같은 경우 > 앞자리부터 1자리가 같은 경우 > 기타
# 순으로 연관성을 보였다.
# (내일 내용까지 배우면 이 부분이 실제인지 증명해볼 수 있지 않을까..?)



































